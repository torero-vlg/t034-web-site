@using T034.Models
@model T034.ViewModel.FolderViewModel

@{
    ViewBag.Title = Model.Name;
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{

    <h2>@Model.Name</h2>
    using (Html.BeginForm("CreateFolder", "Folder"))
    {
        <div  class="input-group">
            @Html.TextBoxFor(m => m.Name, new Dictionary<string, object> { { "class", "form-control" } })
            <span class="input-group-btn">
                <button type="submit" class="btn btn-success">Создать</button>
              </span>
        </div>
    }
        
    <div class="list-group">
        @foreach (var item in Model.Files)
        {
            <a class = "" href="@item.Url">
                <img class="file-icon" src="@item.FileIcon">@item.Name</a>
            @Html.ActionLink("Удалить", "DeleteFile", "Folder", new { url = item.Url }, null)
        }
    </div>
    foreach (var item in Model.SubDirectories)
    {
        <div class="list-group">
            @Html.ActionLink(item.Name, "Edit", "Folder", new { folder = string.Format("{0}{1}/", Model.Name, item.Name) }, new { @class = "list-group-item active" })
            @foreach (var fileViewModel in item.Files)
            {
                <a class = "list-group-item" href="@fileViewModel.Url">
                    <img class="file-icon" src="@fileViewModel.FileIcon">@fileViewModel.Name</a>
            }
        </div>
    }
}

@if (Model.Name != "")
{
    using (Html.BeginForm("DeleteFolder", "Folder"))
    {
        @Html.HiddenFor(m => m.Name)
        <div class="form-actions">
            <button type="submit" class="btn btn-danger">Удалить папку @Model.Name</button>
        </div>
    }
    @Html.Partial("FileUploadPartialView", new FileUploadModel
{
    Url = "UploadFile",
    Folder = Model.Name
})
}